(this.webpackJsonpstranger_things2=this.webpackJsonpstranger_things2||[]).push([[0],{48:function(e,t,s){},49:function(e,t,s){},57:function(e,t,s){"use strict";s.r(t);var n=s(5),r=s(2),a=s(7),c=s.n(a),o=s(13),i=s(3),u=s(0),l=s(18),j=s.n(l),d=s(11),p=s(10);s(48),s(49);function b(e){return h.apply(this,arguments)}function h(){return(h=Object(o.a)(c.a.mark((function e(t){var s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/users/me",{headers:t}).then((function(e){return e.json()})).then((function(e){return e})).catch(console.error);case 2:return s=e.sent,e.abrupt("return",s.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return x.apply(this,arguments)}function x(){return(x=Object(o.a)(c.a.mark((function e(){var t,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/posts");case 3:return t=e.sent,e.next=6,t.json();case 6:return s=e.sent,e.abrupt("return",s.data.posts.reverse());case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function f(e,t){return m.apply(this,arguments)}function m(){return(m=Object(o.a)(c.a.mark((function e(t,s){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("post id to delete ",t),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/posts/".concat(t),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}}).then((function(e){return e.json()})).then((function(e){console.log(e)})).catch(console.error);case 3:e.sent;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){var t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer "+e),t}var v=s(1);function S(e,t){return y.apply(this,arguments)}function y(){return(y=Object(o.a)(c.a.mark((function e(t,s){var n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:t,password:s}})});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,console.log(r.data.token),a=r.data.token,localStorage.setItem("token",a),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t,s){if(t===s)return fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:e,password:t}})}).then((function(e){return e.json()})).then((function(e){return e.data.token})).catch(console.error);alert("Passwords don't match")}var N=function(e){var t=e.setToken,s=e.match,n=e.setHeader,r=e.setUser,a=Object(u.useState)("username"),l=Object(i.a)(a,2),j=l[0],h=l[1],O=Object(u.useState)(""),x=Object(i.a)(O,2),f=x[0],m=x[1],y=Object(u.useState)(""),N=Object(i.a)(y,2),P=N[0],w=N[1],C=Object(p.f)();return Object(v.jsxs)("form",{className:"Route-container",onSubmit:function(){var e=Object(o.a)(c.a.mark((function e(a){var o,i,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a.preventDefault(),o=null,"/register"!==s.url){e.next=7;break}return e.next=6,k(j,f,P);case 6:o=e.sent;case 7:if("/login"!==s.url){e.next=11;break}return e.next=10,S(j,f);case 10:o=e.sent;case 11:if(!o){e.next=21;break}return i=g(o),e.next=15,b(i);case 15:u=e.sent,console.log(u),r(u),n(i),t(o),C.push("/userObject");case 21:console.log(j,f,P),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(0),console.error(e.t0);case 27:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(t){return e.apply(this,arguments)}}(),children:[Object(v.jsx)("br",{}),Object(v.jsxs)("div",{className:"mp-2",children:[Object(v.jsx)("label",{className:"form-label",children:"Username"}),Object(v.jsx)("input",{type:"text",value:j,onChange:function(e){var t=e.target.value;return h(t)},className:"form-control",id:"exampleFormControlInput1",placeholder:"your username"})]}),Object(v.jsx)("br",{}),Object(v.jsxs)("div",{className:"mp-2",children:[Object(v.jsx)("label",{className:"form-lable",children:"Password"}),Object(v.jsx)("input",{type:"password",value:f,minLength:"6",onChange:function(e){var t=e.target.value;return m(t)},className:"form-control",id:"exampleFormControlInput1",placeholder:""})]}),Object(v.jsx)("br",{}),"/register"===s.url?Object(v.jsxs)("div",{className:"mp-2",children:[Object(v.jsx)("label",{className:"form-label",children:"Confirm Password"}),Object(v.jsx)("input",{type:"password",onChange:function(e){var t=e.target.value;return w(t)},value:P,className:"form-control",id:"exampleFormControlInput1",placeholder:""})]}):null,Object(v.jsxs)("div",{className:"col-auto",children:[Object(v.jsx)("button",{type:"submit",className:"btn btn-primary mb-3",children:"Submit"}),"/register"===s.url?Object(v.jsx)(d.b,{to:"/login",children:" Already have an account? "}):Object(v.jsx)(d.b,{to:"/register",children:" Don't have an account? "})]})]})};function P(e){var t=e.headers,s=(e.setPosts,e.posts,e.user),n=e.updateMade,r=e.setUpdateMade,a=Object(u.useState)(""),l=Object(i.a)(a,2),j=l[0],d=l[1],p=Object(u.useState)(""),b=Object(i.a)(p,2),h=b[0],O=b[1],x=Object(u.useState)(""),f=Object(i.a)(x,2),m=f[0],g=f[1];return Object(v.jsxs)("div",{children:[s&&Object(v.jsx)("h4",{children:"Create a new listing"}),s&&Object(v.jsxs)("form",{onSubmit:function(){var e=Object(o.a)(c.a.mark((function e(s){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.preventDefault(),console.log(t),fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/posts",{method:"POST",headers:t,body:JSON.stringify({post:{title:j,description:h,price:m,willDeliver:!0}})}).then((function(e){return e.json()})).then((function(e){r(n+1)})).catch(console.error);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[Object(v.jsx)("input",{type:"text",placeholder:"Title",onChange:function(e){console.log(j),d(e.target.value)},value:j}),Object(v.jsx)("input",{type:"text",placeholder:"Description",onChange:function(e){console.log(h),O(e.target.value)},value:h}),Object(v.jsx)("input",{type:"text",placeholder:"Price",onChange:function(e){console.log(m),g(e.target.value)},value:m}),Object(v.jsx)("button",{type:"submit",children:"Submit"})]})]})}var w=function(e){var t=e.setFilteredResults,s=e.posts,n=Object(u.useState)(""),r=Object(i.a)(n,2),a=r[0],c=r[1];return Object(v.jsxs)("div",{children:[Object(v.jsx)("h4",{children:"Search"}),Object(v.jsx)("input",{value:a,onChange:function(e){c(e.target.value);var n=function(e,t){return t=t.toLowerCase(),e.filter((function(e,s){return e.title.toLowerCase().includes(t)}))}(s,e.target.value);t(n)},placeholder:"search"})]})},C=function(e){e.history;var t=e.updateMade,s=e.setUpdateMade,n=(e.storedToken,e.headers),r=e.setFilteredResults,a=e.filteredResults,c=e.user,o=e.posts,i=e.setPosts;return console.log("now these ",o),Object(v.jsxs)("div",{id:"posts",className:"Route-container",children:[Object(v.jsx)(P,{headers:n,updateMade:t,setUpdateMade:s,setPosts:i,posts:o,user:c}),Object(v.jsx)(w,{posts:o,filteredResults:a,setFilteredResults:r}),Object(v.jsx)("div",{className:"Posts-container",children:a?a.map((function(e,t){var s=e.createdAt.substr(0,10);return Object(v.jsxs)("div",{className:"Single-post",children:[Object(v.jsxs)("div",{children:[Object(v.jsx)("h3",{children:e.title}),Object(v.jsx)("p",{children:e.description}),Object(v.jsx)("h4",{children:e.price}),Object(v.jsxs)("h6",{children:["Posted ",s]})]}),Object(v.jsx)("div",{className:"Details-button",children:Object(v.jsx)(d.b,{to:"/posts/".concat(e._id),children:Object(v.jsx)("button",{type:"button",className:"btn btn-outline-primary",children:" Post Details"})})})]},t)})):null})]})},T=function(e){e.posts,e.setPosts;var t=e.postId,s=(e.setPostId,e.updateMade),n=e.setUpdateMade,r=e.currentPost,a=(e.setCurrentPost,e.headers),l=e.setShowUpdate,j=e.setUpdateSuccess,d=Object(u.useState)(r.title),b=Object(i.a)(d,2),h=b[0],O=b[1],x=Object(u.useState)(r.description),f=Object(i.a)(x,2),m=f[0],g=f[1],S=Object(u.useState)(r.price),y=Object(i.a)(S,2),k=y[0],N=y[1],P=Object(p.f)();Object(u.useEffect)((function(){console.log("update post rendered")}),[]);var w=function(){var e=Object(o.a)(c.a.mark((function e(r){var o,i,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,fetch("http://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/posts/".concat(t),{method:"PATCH",headers:a,body:JSON.stringify({post:{title:h,description:m,price:k,willDeliver:!0}})});case 3:return o=e.sent,e.next=6,o.json();case 6:i=e.sent,u=i.data,console.log("update data: ",u),u&&u.post.title&&(j(!0),n(s+1),O(""),g(""),l(!1),P.push("/"));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("h3",{children:"Update Post"}),Object(v.jsxs)("form",{onSubmit:w,children:[Object(v.jsx)("input",{type:"text",placeholder:"title",value:h,onChange:function(e){return O(e.target.value)}}),Object(v.jsx)("input",{type:"text",placeholder:"description",value:m,onChange:function(e){return g(e.target.value)}}),Object(v.jsx)("input",{type:"text",placeholder:"price",value:k,onChange:function(e){return N(e.target.value)}}),Object(v.jsx)("button",{type:"submit",className:"btn btn-outline-primary",children:"Submit"})]})]})},U=function(e){e.post,e.posts,e.setPosts;var t=e.match,s=e.updateMade,n=e.setUpdateMade,r=e.headers,a=Object(u.useState)(""),l=Object(i.a)(a,2),j=l[0],d=l[1];console.log("these are the headers ",r);var b=Object(p.f)(),h=function(){var e=Object(o.a)(c.a.mark((function e(a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/posts/".concat(t.params.postId,"/messages"),{method:"POST",headers:r,body:JSON.stringify({message:{content:j}})}).then((function(e){return e.json()})).then((function(e){return n(s+1),b.push("/userobject"),e}));case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"Route-container",children:[Object(v.jsx)("h3",{children:"Send Message"}),Object(v.jsxs)("form",{onSubmit:h,children:[Object(v.jsx)("input",{type:"text",placeholder:"message",value:j,onChange:function(e){return d(e.target.value)}}),Object(v.jsx)("button",{type:"submit",className:"btn btn-outline-primary",children:"Submit"})]})]})},M=function(e){var t=e.match,s=e.updateMade,n=e.setUpdateMade,r=(e.post,e.posts),a=e.setPosts,l=e.headers,j=(e.updateSuccess,e.setUpdateSuccess),b=e.user,h=Object(u.useState)(!1),O=Object(i.a)(h,2),x=O[0],m=O[1],g=r.find((function(e){return e._id===t.params.postId}));console.log("CURRENT POST, ",r.find((function(e){return e._id===t.params.postId})));var S=Object(p.f)();return console.log("POSTS AND CURRENT POST, ",r,g),Object(v.jsx)("div",{className:"Single-post-render",children:r.length>0&&Object(v.jsxs)(v.Fragment,{children:[console.log("CURRENT POST WITHIN RENDER, ",g),Object(v.jsxs)("h1",{children:[" ",g.title," "]}),Object(v.jsxs)("p",{children:[" ",g.description," "]}),Object(v.jsxs)("h3",{children:[" ",g.price," "]}),Object(v.jsxs)("h6",{children:[" Posted ",g.createdAt.substr(0,10)," "]}),b&&g&&g.author&&b._id!==g.author._id&&Object(v.jsxs)(d.b,{to:"/posts/sendmessage/".concat(g._id),children:[Object(v.jsx)("button",{type:"button",className:"btn btn-outline-primary",children:"Message"})," "]}),b&&g&&g.author&&b._id===g.author._id&&Object(v.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:function(){m(!0)},children:" Edit"}),b&&g&&g.author&&b._id===g.author._id&&Object(v.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:Object(o.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(g._id,l.Authorization.split(" ")[1]);case 2:n(s+1),S.push("/");case 4:case"end":return e.stop()}}),e)}))),children:" Delete"}),x&&Object(v.jsx)(T,{setShowUpdate:m,currentPost:g,updateMade:s,setUpdateMade:n,postId:t.params.postId,setPosts:a,headers:l,setUpdateSuccess:j})]})})},R=function(e){var t=e.user;e.isLoggedIn,e.headers,e.post,e.posts,e.setPosts,e.storedToken,e.setUser,Object(p.f)();return Object(v.jsx)(v.Fragment,{children:localStorage.getItem("token")?Object(v.jsxs)("div",{id:"userobject",className:"Route-container",children:[Object(v.jsxs)("h5",{children:["Hi, ",t?t.username:"guest"," "]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h4",{children:"Your Messages"}),Object(v.jsx)("div",{className:"Messages-container",children:t&&t.messages?t.messages.map((function(e){return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)("div",{className:"Single-message",children:[Object(v.jsxs)("h4",{children:[e.post.title," "]}),Object(v.jsxs)("p",{children:["From: ",e.fromUser.username]}),Object(v.jsx)("p",{children:e.content})]})})})):null})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("h4",{children:"Your Listings"}),Object(v.jsx)("div",{className:"User-posts-container",children:t?t.posts.filter((function(e){return!0===e.active})).map((function(e){return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)("div",{className:"User-single-post",children:[Object(v.jsxs)("h4",{children:[e.title," "]}),Object(v.jsx)("p",{children:e.description}),Object(v.jsx)("h5",{children:e.price}),Object(v.jsx)("div",{className:"Details-button",children:Object(v.jsxs)("button",{type:"button",className:"btn btn-outline-primary",children:[" ",Object(v.jsx)(d.b,{to:"/posts/".concat(e._id),children:"Post Details"})]})})]})})})):null})]})]}):Object(v.jsx)(p.a,{to:"/"})})},I=s(61),E=s(60),D=s(62),L=function(e){var t=e.token,s=e.setToken,n=(e.setHeader,e.setUser);return Object(v.jsx)(I.a,{fixed:"top",bg:"light",expand:"lg","background-color":"#fafcfc",collapseOnSelect:!0,children:Object(v.jsxs)(E.a,{children:[Object(v.jsx)(I.a.Brand,{href:"/",children:"Strangers' Things"}),Object(v.jsx)(I.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(v.jsx)(I.a.Collapse,{id:"basic-navbar-nav",children:Object(v.jsxs)(D.a,{className:"me-auto",children:[Object(v.jsx)(D.a.Link,{eventKey:"1",children:Object(v.jsx)(d.b,{className:"Header-link",to:"/",children:"Listings"})}),t?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(D.a.Link,{eventKey:"4",children:Object(v.jsx)(d.b,{className:"Header-link",to:"/userObject",children:"Dashboard"})}),Object(v.jsx)(D.a.Link,{eventKey:"5",onClick:function(){localStorage.removeItem("token"),s(null),n(null)},children:"Logout"})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(D.a.Link,{eventKey:"2",children:Object(v.jsx)(d.b,{className:"Header-link",to:"/login",children:"Login"})}),Object(v.jsx)(D.a.Link,{eventKey:"3",children:Object(v.jsx)(d.b,{className:"Header-link",to:"/register",children:"Register"})})]})]})})]})})},F=function(){var e=Object(u.useState)(null),t=Object(i.a)(e,2),s=t[0],a=t[1],l=Object(u.useState)(null),j=Object(i.a)(l,2),h=j[0],x=j[1],f=Object(u.useState)([]),m=Object(i.a)(f,2),S=m[0],y=m[1],k=Object(u.useState)(null),P=Object(i.a)(k,2),w=(P[0],P[1],Object(u.useState)(null)),T=Object(i.a)(w,2),I=T[0],E=T[1],D=Object(u.useState)(!1),F=Object(i.a)(D,2),_=F[0],B=F[1],H=Object(u.useState)([]),W=Object(i.a)(H,2),A=W[0],J=W[1],K=Object(u.useState)(0),z=Object(i.a)(K,2),Y=z[0],q=z[1];return Object(u.useEffect)(Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:t=e.sent,y(t),J(t);case 5:case"end":return e.stop()}}),e)}))),[_,Y]),Object(u.useEffect)(Object(o.a)(c.a.mark((function e(){var t,s,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("token"))){e.next=9;break}return a(t),s=g(t),x(s),e.next=7,b(s);case 7:n=e.sent,E(n);case 9:case"end":return e.stop()}}),e)}))),[Y]),Object(v.jsxs)(d.a,{children:[Object(v.jsx)(L,{token:s,setToken:a,setUser:E}),Object(v.jsxs)("div",{className:"Routes",children:[Object(v.jsx)(p.b,{path:"/login",render:function(e){return Object(v.jsx)(N,Object(r.a)(Object(r.a)({},e),{},{setHeader:x,setToken:a,setUser:E}))}}),Object(v.jsx)(p.b,{path:"/register",render:function(e){return Object(v.jsx)(N,Object(r.a)(Object(r.a)({},e),{},{setHeader:x,setToken:a,setUser:E}))}}),Object(v.jsx)(p.b,{path:"/",exact:!0,render:function(e){return Object(v.jsx)(C,Object(r.a)(Object(r.a)({},e),{},{updateMade:Y,setUpdateMade:q,setPosts:y,posts:S,user:I,filteredResults:A,setFilteredResults:J,isLoggedIn:!!s,storedToken:s,headers:h}))}}),Object(v.jsx)(p.b,{path:"/posts/:postId",exact:!0,render:function(e){return Object(v.jsx)(M,Object(r.a)(Object(r.a)({},e),{},{updateMade:Y,setUpdateMade:q,posts:S,setPosts:y,headers:h,user:I,updateSuccess:_,setUpdateSuccess:B}))}}),Object(v.jsx)(p.b,{path:"/posts/sendmessage/:postId",exact:!0,render:function(e){return Object(v.jsx)(U,Object(r.a)(Object(r.a)({},e),{},{updateMade:Y,setUpdateMade:q,storedToken:s,headers:h}))}}),Object(v.jsx)(p.b,{path:"/userobject",render:function(e){var t;return Object(v.jsx)(R,Object(r.a)(Object(r.a)({},e),{},(t={user:I,posts:S,setPosts:y,setUser:E},Object(n.a)(t,"setPosts",y),Object(n.a)(t,"isLoggedIn",!!s),Object(n.a)(t,"storedToken",s),Object(n.a)(t,"headers",h),t)))}})]})]})};j.a.render(Object(v.jsx)(F,{}),document.getElementById("app"))}},[[57,1,2]]]);
//# sourceMappingURL=main.d4158cbf.chunk.js.map